version: 0.2

phases:
  install:
    runtime-versions:
      python: 3.10
    commands:
      - echo "Instalando dependÃªncias..."
      - pip install -r app/requirements.txt
      - pip install pytest jsonschema
  build:
    commands:
      - echo "========== INICIANDO TESTES =========="
      - export PYTHONPATH=app

      - echo "ðŸ”¹ Executando testes unitÃ¡rios..."
      - pytest app/test_app.py -k "test_soma_ok or test_soma_invalida or test_inverter_texto" --maxfail=1 --disable-warnings -q

      - echo "ðŸ”¹ Executando testes de integraÃ§Ã£o..."
      - pytest app/test_app.py -k "test_fluxo_completo" --maxfail=1 --disable-warnings -q

      - echo "ðŸ”¹ Executando testes de contrato..."
      - pytest app/test_app.py -k "test_soma_contrato" --maxfail=1 --disable-warnings -q

      - echo "ðŸ”¹ Executando testes de validaÃ§Ã£o de erro..."
      - pytest app/test_app.py -k "test_soma_parametro_faltando or test_inverter_sem_json" --maxfail=1 --disable-warnings -q

      - echo "âœ… Todos os testes foram executados."
artifacts:
  files:
    - '**/*'

